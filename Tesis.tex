\documentclass[oneside]{usachtesis} %%clase para tesis usach
\usepackage[cm]{sfmath}

%%package para bibliografía
\usepackage{natbib}

\usepackage{mhchem}

\usepackage{fancyhdr}

\usepackage{titlesec}

\usepackage{gensymb}

\usepackage{subcaption}

\usepackage{pgfplots}
\usepackage{pgfplotstable,tabularx,booktabs}
\usetikzlibrary{external}
%\usepgfplotslibrary{external}
\tikzexternalize[prefix=Imagenes/tikzext/]

\usetikzlibrary{positioning}

\newcommand{\plotwidth}{0.3\textwidth}
\newcommand{\plotscale}{0.8}

\pgfplotsset{
	compat=1.15,
	CVStyle/.style={
		title=Voltametría Cíclica,
		domain=-0.8:0.8,
		xtick distance=0.4,
		minor tick num=1,
		ylabel={Densidad de corriente [A/g]},
		xlabel={Voltaje [V]},
		every axis legend/.append style={
			font=\tiny,
			at={(0.98,0.02)},
			anchor=south east,
		},
		legend entries={25mV/s,50mV/s,100mV/s,200mV/s,400mV/s},
		cycle list name=exotic,
		no markers,
	},
	SCStyle/.style={
		title=Capacidad Específica,
		domain=25:400,
		ylabel={Capacidad específica [F/g]},
		xlabel={Velocidad de barrido [mV/s]},
		every axis legend/.append style={
			font=\tiny,
			at={(0.98,0.98)},
			anchor=north east,
		},
		legend entries={Antes, Después},
		cycle list name=exotic,
	},
	EISStyle/.style={
		title=Espectro de impedancia electroquímica,
		domain=0:50,
		ylabel={-Z imag [Ohm]},
		xlabel={Z real [Ohm]},
		cycle list name=exotic,	
	},
	CCDStyle/.style={
		title=Carga y descarga cíclica,
		ylabel={Voltaje [V]},
		xlabel={Tiempo [s]},
		cycle list name=exotic,
		mark size = 0.2pt,
		line width = 0.1pt,
%		only markers,
		every axis legend/.append style={
			font=\tiny,
			at={(0.98,0.02)},
			anchor=south east,
		},
		legend entries={Primeros ciclos, Últimos ciclos},
	},
}


\fancypagestyle{plain}{%
	\fancyhf{} % clear all header and footer fields
	\fancyhead{} % clear all header fields
	\fancyfoot{} % clear all footer fields
	\fancyfoot[RO]{\thepage}
	\renewcommand{\headrulewidth}{0pt}
	\renewcommand{\footrulewidth}{0pt}
}
\pagestyle{plain}

\titleformat{\chapter}
{\normalfont\bfseries}{\thechapter}{11pt}{}

\titleformat{\section}
{\normalfont\bfseries}{\thesection}{10pt}{}

\titleformat{\subsection}
{\normalfont}{\thesubsection}{1em}{}

\titleformat{\subsubsection}
{\normalfont}{\thesubsubsection}{1em}{}


%\sansmath % Enable sans-serif math for rest of document

\makeindex
\setcounter{tocdepth}{1}

\graphicspath{{Imagenes/}}

\DeclareRobustCommand*\circled[1]{
	\tikz[baseline=-5]{\node[draw,circle,inner sep=1pt] {#1};}
	}

%#1:filename, #2:filename, #3:mass,#4:ccdDomain, #5ccdTime, #6 caption, #7 mass abs err
\newcommand{\SCGraphs}[7]{
	\pgfmathsetmacro\SCError{1/#3*#7}
	\begin{figure}
		\centering
		\begin{subfigure}{\plotwidth}
			\begin{tikzpicture}[scale=\plotscale,trim axis right,trim axis left]
			\begin{axis}[CVStyle]
			\addplot table [x=Voltaje, y expr=\thisrow{Corriente}/#3 ] {./Data/#1/raw/sample1.txt};
			\addplot table [x=Voltaje, y expr=\thisrow{Corriente}/#3 ] {./Data/#1/raw/sample2.txt};
			\addplot table [x=Voltaje, y expr=\thisrow{Corriente}/#3 ] {./Data/#1/raw/sample3.txt};
			\addplot table [x=Voltaje, y expr=\thisrow{Corriente}/#3 ] {./Data/#1/raw/sample4.txt};
			\addplot table [x=Voltaje, y expr=\thisrow{Corriente}/#3 ] {./Data/#1/raw/sample5.txt};	
			\end{axis}
			\end{tikzpicture}
		\end{subfigure}\hfill
		\begin{subfigure}{\plotwidth}
			\begin{tikzpicture}[scale=\plotscale,trim axis right,trim axis left]
			\begin{axis}[CVStyle]
			\addplot table [x=Voltaje, y expr=\thisrow{Corriente}/#3 ] {./Data/#2/raw/sample1.txt};
			\addplot table [x=Voltaje, y expr=\thisrow{Corriente}/#3 ] {./Data/#2/raw/sample2.txt};
			\addplot table [x=Voltaje, y expr=\thisrow{Corriente}/#3 ] {./Data/#2/raw/sample3.txt};
			\addplot table [x=Voltaje, y expr=\thisrow{Corriente}/#3 ] {./Data/#2/raw/sample4.txt};
			\addplot table [x=Voltaje, y expr=\thisrow{Corriente}/#3 ] {./Data/#2/raw/sample5.txt};	
			\end{axis}
			\end{tikzpicture}
		\end{subfigure}\\
		\begin{subfigure}{\plotwidth}
			\begin{tikzpicture}[scale=\plotscale,trim axis right,trim axis left]
			\begin{axis}[CCDStyle]
			\addplot+[restrict x to domain=0:#4] table [ x expr=\thisrow{Time}-0, y expr=\thisrow{Voltage} ] {./Data/#1/raw/chargedischarge.txt};	
			\addplot+[restrict x to domain=0:#4] table [ x expr=\thisrow{Time}-#5, y expr=\thisrow{Voltage} ] {./Data/#1/raw/chargedischarge.txt};
			\end{axis}
			\end{tikzpicture}
		\end{subfigure}\hfill
		\begin{subfigure}{\plotwidth}
			\begin{tikzpicture}[scale=\plotscale,trim axis right,trim axis left]
			\pgfplotstableread{./Data/#1/raw/eisgalv.txt}{\eistable};
			\pgfplotstablegetrowsof{\eistable}
			\pgfmathsetmacro{\N}{\pgfplotsretval}
			\begin{axis}[EISStyle]
			\addplot table [only marks, x=Zreal, y expr=\thisrow{Zimag}*-1] {\eistable}
			node[pos=(1-1)/(\N-1), pin=right:{1 MHz}]{}
			node[pos=(\N-1)/(\N-1), pin=left:{0,1 Hz}]{};
			\end{axis}
			\end{tikzpicture}
		\end{subfigure}\\
		\begin{subfigure}{\plotwidth}
			\begin{tikzpicture}[scale=\plotscale,trim axis right,trim axis left]
			\begin{axis}[SCStyle]
			\addplot+ [error bars/.cd, y dir=both, y fixed relative=\SCError,] table [only marks] {./Data/#1/raw/capacitance.txt};
			\addplot+ [error bars/.cd, y dir=both, y fixed relative=\SCError,] table [only marks] {./Data/#2/raw/capacitance.txt};	
			\end{axis}
			\end{tikzpicture}
		\end{subfigure}\hfill	
		\begin{subfigure}{\plotwidth}
			\begin{tikzpicture}[scale=\plotscale,trim axis right,trim axis left]
			\begin{axis}[CVStyle,
			legend entries={25mV/s antes, 25mV/s después,  400mV/s antes, 400mV/s después}]
			\addplot table [x=Voltaje, y expr=\thisrow{Corriente}/#3 ] {./Data/#1/raw/sample1.txt};
			\addplot table [x=Voltaje, y expr=\thisrow{Corriente}/#3 ] {./Data/#2/raw/sample1.txt};
			\addplot table [x=Voltaje, y expr=\thisrow{Corriente}/#3 ] {./Data/#1/raw/sample5.txt};
			\addplot table [x=Voltaje, y expr=\thisrow{Corriente}/#3 ] {./Data/#2/raw/sample5.txt};
			\end{axis}
			\end{tikzpicture}
		\end{subfigure}
		\caption[Resultados: #6]{#6}
		\label{SCGraphs:#1}
	\end{figure}	
}

%#1:filename, #2:filename, #3:mass,#4:ccdDomain, #5ccdTime, #6 caption
\newcommand{\SCGraphsNoMass}[6]{
	\begin{figure}
		\centering
		\begin{subfigure}{\plotwidth}
			\begin{tikzpicture}[scale=\plotscale,trim axis right,trim axis left]
			\begin{axis}[CVStyle,
			scaled ticks=base 10:6,
			ylabel = {Corriente [A]},]
			\addplot table [x=Voltaje, y expr=\thisrow{Corriente} ] {./Data/#1/raw/sample1.txt};
			\addplot table [x=Voltaje, y expr=\thisrow{Corriente} ] {./Data/#1/raw/sample2.txt};
			\addplot table [x=Voltaje, y expr=\thisrow{Corriente} ] {./Data/#1/raw/sample3.txt};
			\addplot table [x=Voltaje, y expr=\thisrow{Corriente} ] {./Data/#1/raw/sample4.txt};
			\addplot table [x=Voltaje, y expr=\thisrow{Corriente} ] {./Data/#1/raw/sample5.txt};	
			\end{axis}
			\end{tikzpicture}
		\end{subfigure}\hfill
		\begin{subfigure}{\plotwidth}
			\begin{tikzpicture}[scale=\plotscale,trim axis right,trim axis left]
			\begin{axis}[CVStyle,
			scaled ticks=base 10:6,
			ylabel = {Corriente [A]},]
			\addplot table [x=Voltaje, y expr=\thisrow{Corriente} ] {./Data/#2/raw/sample1.txt};
			\addplot table [x=Voltaje, y expr=\thisrow{Corriente} ] {./Data/#2/raw/sample2.txt};
			\addplot table [x=Voltaje, y expr=\thisrow{Corriente} ] {./Data/#2/raw/sample3.txt};
			\addplot table [x=Voltaje, y expr=\thisrow{Corriente} ] {./Data/#2/raw/sample4.txt};
			\addplot table [x=Voltaje, y expr=\thisrow{Corriente} ] {./Data/#2/raw/sample5.txt};	
			\end{axis}
			\end{tikzpicture}
		\end{subfigure}\\
		\begin{subfigure}{\plotwidth}
			\begin{tikzpicture}[scale=\plotscale,trim axis right,trim axis left]
			\begin{axis}[CCDStyle]
			\addplot+[restrict x to domain=0:#4] table [ x expr=\thisrow{Time}-0, y expr=\thisrow{Voltage} ] {./Data/#1/raw/chargedischarge.txt};	
			\addplot+[restrict x to domain=0:#4] table [ x expr=\thisrow{Time}-#5, y expr=\thisrow{Voltage} ] {./Data/#1/raw/chargedischarge.txt};
			\end{axis}
			\end{tikzpicture}
		\end{subfigure}\hfill
		\begin{subfigure}{\plotwidth}
			\begin{tikzpicture}[scale=\plotscale,trim axis right,trim axis left]
			\pgfplotstableread{./Data/#1/raw/eisgalv.txt}{\eistable};
			\pgfplotstablegetrowsof{\eistable}
			\pgfmathsetmacro{\N}{\pgfplotsretval}
			\begin{axis}[EISStyle]
			\addplot table [only marks, x=Zreal, y expr=\thisrow{Zimag}*-1] {\eistable}
			node[pos=(1-1)/(\N-1), pin=right:{1 MHz}]{}
			node[pos=(\N-1)/(\N-1), pin=below:{0,1 Hz}]{};
			\end{axis}
			\end{tikzpicture}
		\end{subfigure}\\
		\begin{subfigure}{\plotwidth}
			\begin{tikzpicture}[scale=\plotscale,trim axis right,trim axis left]
			\begin{axis}[SCStyle,
			ylabel = {Capacidad [F]}]
			\addplot+ [error bars/.cd, y dir=both, y fixed=0.1,] table [only marks] {./Data/#1/raw/capacitance.txt};
			\addplot+ [error bars/.cd, y dir=both, y fixed=0.1,] table [only marks] {./Data/#2/raw/capacitance.txt};	
			\end{axis}
			\end{tikzpicture}
		\end{subfigure}\hfill	
		\begin{subfigure}{\plotwidth}
			\begin{tikzpicture}[scale=\plotscale,trim axis right,trim axis left]
			\begin{axis}[CVStyle,
			scaled ticks=base 10:6,
			ylabel = {Corriente [A]},
			legend entries={25mV/s antes, 25mV/s después,  400mV/s antes, 400mV/s después},]
			\addplot table [x=Voltaje, y expr=\thisrow{Corriente} ] {./Data/#1/raw/sample1.txt};
			\addplot table [x=Voltaje, y expr=\thisrow{Corriente} ] {./Data/#2/raw/sample1.txt};
			\addplot table [x=Voltaje, y expr=\thisrow{Corriente} ] {./Data/#1/raw/sample5.txt};
			\addplot table [x=Voltaje, y expr=\thisrow{Corriente} ] {./Data/#2/raw/sample5.txt};
			\end{axis}
			\end{tikzpicture}
		\end{subfigure}
		\caption[Resultados: #6]{#6}
		\label{SCGraphs:#1}
	\end{figure}	
}

%============================================================
%===================Comienzo del documento===================
%============================================================
\begin{document}
%%PORTADA						
 \title{Síntesis de Grafeno por medios químicos y construcción de supercondensadores basados en grafeno}
 \author{Carlos Javier Eugenio Herrera}
 \facultad{CIENCIA}
 \departamento{FÍSICA}
 \profesorguia{DINESH PRATAP SINGH}
 \tituloprofesional{Ingeniero Físico}
 \anolol{2017}
 
\begin{titlepage}
	\maketitle
\end{titlepage}

\newpage
\mbox{}
\thispagestyle{empty}
\pagenumbering{roman}

%%DERECHOS DE AUTOR
\derechosdeautor

%%HOJA DE CALIFICACIONES
\newpage
\thispagestyle{empty}

%%DEDICATORIA
\newpage
\chapter*{}
\begin{flushright}
\textit{Dedicado a...}
\end{flushright}
\newpage

%%AGRADECIMIENTOS(OPTATIVA)
\chapter*{Agradecimientos}

%%TABLA DE CONTENIDOS
\newpage
\tableofcontents
\newpage
\newrgbcolor{xdxdff}{0.49 0.49 1}
\newrgbcolor{ffqqtt}{1 0 0.2}
\psset{xunit=1.0cm,yunit=1.0cm,algebraic=true,dotstyle=*,dotsize=3pt
0,linewidth=0.8pt,arrowsize=3pt 2,arrowinset=0.25}

%%ÍNDICE DE TABLAS
\newpage
\listoftables
\newrgbcolor{xdxdff}{0.49 0.49 1}
\newrgbcolor{ffqqtt}{1 0 0.2}
\psset{xunit=1.0cm,yunit=1.0cm,algebraic=true,dotstyle=*,dotsize=3pt
	0,linewidth=0.8pt,arrowsize=3pt 2,arrowinset=0.25}

%%INDICE DE ILUSTRACIONES
\newpage
\listoffigures
\newrgbcolor{xdxdff}{0.49 0.49 1}
\newrgbcolor{ffqqtt}{1 0 0.2}
\psset{xunit=1.0cm,yunit=1.0cm,algebraic=true,dotstyle=*,dotsize=3pt
0,linewidth=0.8pt,arrowsize=3pt 2,arrowinset=0.25}

%%RESUMEN
\newpage
\include{Resumen}

%%INTRODUCCIÓN
\newpage




%%CAPÍTULOS
\newpage
\pagenumbering{arabic}
\include{Introduccion}
\include{Marco_teorico}
\include{Cuerpo_tesis}
\include{Conclusiones}
%\include{Anexo}

%%ÍNDICE ANALÍTICO
%\newpage
%\printindex
%\addcontentsline{toc}{chapter}{Índice Analítico}

%%BIBLIOGRAFÍA
\newpage

\bibliography{Nanosintesis}
\bibliographystyle{apalike}

\end{document}